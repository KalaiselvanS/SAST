<?xml version="1.0" encoding="utf-8"?>
<xs:schema xmlns="xmlns://www.fortifysoftware.com/schema/pentestimport" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="xmlns://www.fortifysoftware.com/schema/pentestimport" elementFormDefault="qualified" version="1.0" xml:lang="en">
	<xs:element name="PenTestImport">
		<xs:complexType>
			<xs:sequence>
				<xs:element ref="SecurityProduct"/>
				<xs:element ref="Scan"/>
			</xs:sequence>
			<xs:attribute name="version" type="xs:string" use="required"/>
		</xs:complexType>
	</xs:element>
	<xs:element name="SecurityProduct">
		<xs:complexType>
			<xs:sequence>
				<xs:element name="Name" type="xs:string"/>
				<xs:element name="Version" type="xs:string" minOccurs="0"/>
				<xs:element name="EngineType" type="xs:string">
					<xs:annotation>
						<xs:documentation>
							WebInspect must use "WEBINSPECT".
						</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="RequestIdHeaderName" type="xs:string">
					<xs:annotation>
						<xs:documentation>The name of the header that will be used to correlate requests sent during runtime and requests detailed in a pen test import file.</xs:documentation>
					</xs:annotation>
				</xs:element>
			</xs:sequence>
		</xs:complexType>
	</xs:element>
	<xs:element name="Scan">
		<xs:complexType>
			<xs:sequence>
				<xs:element ref="ScanInfo"/>
				<xs:element ref="Issues" minOccurs="0"/>
			</xs:sequence>
		</xs:complexType>
	</xs:element>
	<xs:element name="ScanInfo">
		<xs:complexType>
			<xs:sequence>
				<xs:element name="Label" type="xs:string" minOccurs="0"/>
				<xs:element name="StartDate" type="xs:dateTime">
					<xs:annotation>
						<xs:documentation>The date and time the scan started.</xs:documentation>
				  	</xs:annotation>
				</xs:element>
				<xs:element name="EndDate" type="xs:dateTime">
					<xs:annotation>
						<xs:documentation>The date and time the scan ended.</xs:documentation>
				  	</xs:annotation>
				</xs:element>
				<xs:element ref="Host" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:complexType>
	</xs:element>
	<xs:element name="Issues">
		<xs:complexType>
			<xs:sequence>
				<xs:element ref="Issue" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:complexType>
	</xs:element>
	<xs:element name="Issue">
		<xs:complexType>
			<xs:sequence>
				<xs:element name="GUID" type="xs:string">
					<xs:annotation>
						<xs:documentation>globally unique id for this issue.  This GUID will be used for the same issue if it exists in other scans.</xs:documentation>
				  </xs:annotation>
				</xs:element>
				<xs:element name="HostID" type="xs:string">
					<xs:annotation>
						<xs:documentation>ID of the Host defined by a Host element</xs:documentation>
				  </xs:annotation>
				</xs:element>
				<xs:element name="URL" type="xs:string">
					<xs:annotation>
						<xs:documentation>URL affected by this issue.  This includes the context path.</xs:documentation>
				  </xs:annotation>
				</xs:element>
				<xs:element ref="Requests"/>
				<xs:element name="Category" type="xs:string">
					<xs:annotation>
						<xs:documentation>Vulnerability category of this issue.</xs:documentation>
				  </xs:annotation>
				</xs:element>
				<xs:element name="FortifyCategory" type="xs:string" minOccurs="0">
					<xs:annotation>
						<xs:documentation>The equivalent Fortify category for this issue, if known.</xs:documentation>
				  </xs:annotation>
				</xs:element>
				<xs:element name="Priority" type="PrioritySpecifier"/>
				<xs:element name="IssueDescription" type="xs:string" minOccurs="0">
          		<xs:annotation>
				   	<xs:documentation>Issue-specific description.</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:any minOccurs="0">
					<xs:annotation>
						<xs:documentation>The StandardizedCategories element has been removed.  All category mappings will now be done through External Metadata Files.</xs:documentation>
					</xs:annotation>
				</xs:any>
			</xs:sequence>
		</xs:complexType>
	</xs:element>
	<xs:element name="Requests">
		<xs:complexType>
			<xs:sequence>
				<xs:element name="PrimaryRequest" type="Request" maxOccurs="1"/>
				<xs:element name="SecondaryRequest" type="Request" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:complexType>
	</xs:element>
	<xs:complexType name="Request">
		<xs:sequence>
			<xs:element name="Method" type="xs:string">
		      <xs:annotation>
			   	<xs:documentation>HTTP method used to send this request</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="HTTPVersion" type="xs:string">
	   	   <xs:annotation>
			   	<xs:documentation>HTTP version</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element name="Headers" minOccurs="0">
		      <xs:annotation>
			   	<xs:documentation>Headers(including cookie headers) sent in this request.</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="Header" type="NameValuePair" minOccurs="0" maxOccurs="unbounded"/>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
			<xs:element name="Parameters" minOccurs="0">
	      	<xs:annotation>
			   	<xs:documentation>Parameters for this request.</xs:documentation>
				</xs:annotation>
				<xs:complexType>
					<xs:sequence>
						<xs:element name="Parameter" type="NameValuePair" minOccurs="0" maxOccurs="unbounded"/>
					</xs:sequence>
				</xs:complexType>
			</xs:element>
			<xs:element name="Body" type="xs:string" minOccurs="0">
				<xs:annotation>
					<xs:documentation>The body for this request.</xs:documentation>
				</xs:annotation>
			</xs:element>
			<xs:element ref="AttackInfo"/>
			<xs:element ref="Response"/>
		</xs:sequence>
	</xs:complexType>
	<xs:element name="Response">
		<xs:complexType>
			<xs:sequence>
				<xs:element name="RawResponse" type="xs:string">
					<xs:annotation>
						 <xs:documentation>The HTTP response.</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element ref="Triggers" minOccurs="0"/>
			</xs:sequence>
		</xs:complexType>
	</xs:element>
	<xs:element name="Triggers">
		<xs:complexType>
			<xs:sequence>
				<xs:element ref="Trigger" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:complexType>
	</xs:element>
	<xs:element name="Trigger">
		<xs:complexType>
			<xs:sequence>
				<xs:element name="Location" type="xs:int">
					<xs:annotation>
						<xs:documentation>The starting location in the response that triggered the issue.</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="Length" type="xs:int">
					<xs:annotation>
						<xs:documentation>The length of the string that triggered the issue.</xs:documentation>
					</xs:annotation>
				</xs:element>
				<xs:element name="String" type="xs:string">
					<xs:annotation>
						<xs:documentation>The actual string in the response that triggered the issue.</xs:documentation>
					</xs:annotation>
				</xs:element>
			</xs:sequence>
		</xs:complexType>
	</xs:element>
	<xs:element name="AttackInfo">
		<xs:annotation>
			<xs:documentation>The attack payload.</xs:documentation>
		</xs:annotation>
		<xs:complexType>
			<xs:sequence>
				<xs:element name="PrimaryAttack" type="Attack"/>
				<xs:any minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:complexType>
	</xs:element>
	<xs:complexType name="Attack">
		<xs:sequence>
			<xs:element name="AttackType" type="AttackSpecifier"/>
			<xs:element name="Payload" type="xs:string"/>
		</xs:sequence>
	</xs:complexType>
	<xs:simpleType name="PrioritySpecifier">
		<xs:annotation>
			<xs:documentation>The Fortify Priority values.</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:enumeration value="Critical"/>
			<xs:enumeration value="High"/>
			<xs:enumeration value="Medium"/>
			<xs:enumeration value="Low"/>
		</xs:restriction>
  	</xs:simpleType>
	<xs:simpleType name="AttackSpecifier">
		<xs:annotation>
			<xs:documentation>Attack types.</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:enumeration value="URL"/>
			<xs:enumeration value="REQUEST_COOKIE"/>
			<xs:enumeration value="REQUEST_HEADER">
				<xs:annotation>
					<xs:documentation>For a non-cookie header attack.</xs:documentation>
				</xs:annotation>
			</xs:enumeration>
			<xs:enumeration value="PARAMETER"/>
			<xs:enumeration value="MULTIPLE">
				<xs:annotation>
					<xs:documentation>If multiple attacks are used.</xs:documentation>
				</xs:annotation>
			</xs:enumeration>
		</xs:restriction>
	</xs:simpleType>

	<xs:element name="Host">
		<xs:complexType>
			<xs:sequence>
				<xs:element name="HostID" type="xs:string">
	      	<xs:annotation>
	      		<xs:documentation>ID to identify this host within the results file</xs:documentation>
	      	</xs:annotation>
				</xs:element>
				<xs:element name="Hostname" type="xs:string"/>
				<xs:element name="Port" type="xs:int"/>
				<xs:element name="ContextPath" type="xs:string"/>
			</xs:sequence>
		</xs:complexType>	
	</xs:element>
	
	<xs:complexType name="NameValuePair">
		<xs:sequence>
			<xs:element name="Name" type="xs:string"/>
			<xs:element name="Value" type="xs:string"/>
		</xs:sequence>
	</xs:complexType>
</xs:schema>
